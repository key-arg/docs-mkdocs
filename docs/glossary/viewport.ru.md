# Вьюпорт

**Вьюпорт** (Viewport) — это видимая область веб-страницы в пределах окна браузера или экрана мобильного устройства. Эта фундаментальная концепция в веб-разработке и аналитике определяет, какой контент пользователи могут видеть без прокрутки, непосредственно влияя на пользовательский опыт, дизайнерские решения и метрики вовлечённости.

## Размеры вьюпорта и устройства

### Распространённые размеры вьюпортов

Вьюпорт представляет видимую область просмотра пользователя, исключая элементы браузера, такие как панели инструментов, адресная строка и полосы прокрутки.

**Десктопные вьюпорты обычно варьируются:**

- Минимальные: 1024×768 пикселей (старые стандарты)
- Распространённые: 1366×768, 1920×1080 (Full HD)
- Большие: 2560×1440 (2K), 3840×2160 (4K)

**Мобильные вьюпорты показывают ещё большее разнообразие:**

- Телефоны: 360×640 до 428×926 пикселей
- Планшеты: 768×1024 до 1366×1024 пикселей
- Складные устройства: Динамические вьюпорты, меняющиеся с ориентацией устройства

!!! info "Важное различие"
    Разрешение экрана отличается от размера вьюпорта. Устройство с 2880×1440 физическими пикселями может иметь вьюпорт 360×640 CSS-пикселей из-за масштабирования соотношения пикселей устройства (DPR).

## Типы вьюпортов и их особенности

### Вьюпорт макета (Layout Viewport)

Вьюпорт макета содержит весь макет страницы, который может выходить за пределы видимой области. На мобильных устройствах он обычно шире визуального вьюпорта для размещения сайтов, разработанных для десктопа:

```html
<meta name="viewport" content="width=980">
```

Это устанавливает фиксированный вьюпорт макета шириной 980 пикселей, распространённый для неадаптивных сайтов.

### Визуальный вьюпорт (Visual Viewport)

Визуальный вьюпорт представляет то, что в данный момент видно на экране. Пользователи могут масштабировать и панорамировать для перемещения визуального вьюпорта по большему вьюпорту макета:

Ключевые свойства включают:

- `window.innerWidth` и `window.innerHeight` для размеров
- `window.pageXOffset` и `window.pageYOffset` для позиции прокрутки
- API `visualViewport` для точных измерений

### Идеальный вьюпорт (Ideal Viewport)

Идеальный вьюпорт — это оптимальный размер для устройства при отображении адаптивного контента:

```html
<meta name="viewport" content="width=device-width, initial-scale=1">
```

Это обеспечивает идеальное соответствие контента без горизонтальной прокрутки или нежелательного масштабирования.

## Контент "над сгибом"

"Над сгибом" (above-the-fold) относится к контенту, видимому в начальном вьюпорте без прокрутки. Эта премиальная область значительно влияет на метрики:

### Влияние на пользовательскую вовлечённость

**Статистика взаимодействия:**

- Первые впечатления формируются за 50 миллисекунд
- 80% времени просмотра проводится над сгибом
- 70% пользователей никогда не прокручивают на лендингах

**Метрики производительности:**

- Largest Contentful Paint (LCP) должен происходить над сгибом
- Видимость First Contentful Paint (FCP)
- Cumulative Layout Shift (CLS) во вьюпорте

**Оптимизация конверсии:**

- Основные CTA должны появляться над сгибом
- Ключевые ценностные предложения должны быть сразу видны
- Размещение сигналов доверия и социального доказательства

## Техническая реализация

### Мета-тег viewport

Мета-тег viewport контролирует отображение контента мобильными браузерами:

```html
<!-- Лучшая практика для адаптивного дизайна -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
```

Основные свойства мета-тега viewport:

| Свойство | Описание | Значения |
|----------|----------|----------|
| width | Контролирует ширину вьюпорта | device-width, конкретное значение |
| initial-scale | Устанавливает начальный уровень масштаба | 0.1 до 10 (1 = 100%) |
| maximum-scale | Максимально допустимый масштаб | 0.1 до 10 |
| minimum-scale | Минимально допустимый масштаб | 0.1 до 10 |
| user-scalable | Разрешает масштабирование пальцами | yes/no |

### JavaScript определение вьюпорта

Современный JavaScript предоставляет несколько способов определения размеров вьюпорта:

```javascript
// Базовые размеры вьюпорта
const viewportWidth = window.innerWidth;
const viewportHeight = window.innerHeight;

// Visual Viewport API (современные браузеры)
if (window.visualViewport) {
  const vv = window.visualViewport;
  console.log(`Ширина: ${vv.width}, Высота: ${vv.height}`);
  console.log(`Масштаб: ${vv.scale}, Смещение: ${vv.offsetLeft}, ${vv.offsetTop}`);
}

// Обнаружение изменений вьюпорта
window.addEventListener('resize', () => {
  // Обработка изменения размера вьюпорта
});

window.visualViewport?.addEventListener('resize', () => {
  // Обработка изменений визуального вьюпорта (масштаб, клавиатура)
});
```

### CSS единицы вьюпорта

CSS предоставляет относительные единицы вьюпорта для адаптивного дизайна:

- `vw` — 1% ширины вьюпорта
- `vh` — 1% высоты вьюпорта
- `vmin` — 1% меньшего измерения вьюпорта
- `vmax` — 1% большего измерения вьюпорта
- `dvh`, `svh`, `lvh` — динамическая, малая и большая высота вьюпорта (новые единицы)

!!! warning "Особенности мобильных браузеров"
    Мобильные браузеры имеют динамическую высоту вьюпорта из-за сворачивающихся адресных панелей. Новые единицы вьюпорта (dvh, svh, lvh) решают эту несогласованность.

## Вьюпорт в веб-аналитике

### Отслеживание и анализ

Аналитические платформы отслеживают размеры вьюпорта для понимания контекста пользователя и паттернов поведения:

**Анализ видимости контента:**

- Экспозиция контента над сгибом
- Показатели видимости элементов
- Требования к глубине прокрутки
- Эффективность позиционирования призывов к действию

**Метрики пользовательского опыта:**

- Паттерны использования мобильных vs десктопных устройств
- Распределение размеров экранов
- Предпочтения ориентации (портрет/ландшафт)
- Использование уровня масштабирования

!!! tip "Реализация аналитики"
    Отслеживайте размеры вьюпорта при загрузке страницы и событиях изменения размера. Сохраняйте начальный размер вьюпорта отдельно от текущего для понимания пользовательских корректировок.

### Ключевые метрики для мониторинга

**Распределение размеров:**

- Наиболее распространённые размеры вьюпортов
- Соотношение мобильных к десктопным
- Использование портретной vs ландшафтной ориентации
- Тренды разрешений экранов

**Паттерны поведения:**

- Глубина прокрутки по размеру вьюпорта
- Коэффициенты конверсии по категории вьюпорта
- Показатели отказов, коррелирующие с вьюпортом
- Время на сайте по типу устройства

**Индикаторы производительности:**

- Время загрузки по размеру вьюпорта
- Метрики производительности рендеринга
- Задержки взаимодействия по категории устройства

## Адаптивный дизайн и брейкпоинты

### Планирование брейкпоинтов

Распространённые брейкпоинты вьюпорта для адаптивного дизайна:

| Категория устройства | Брейкпоинт | Типичное использование |
|--------------------|------------|------------------------|
| Мобильный | <576px | Одна колонка, оптимизировано для касаний |
| Планшет (портрет) | 576-768px | Две колонки, большие цели касания |
| Планшет (ландшафт) | 768-992px | Многоколоночный, навигация как на десктопе |
| Десктоп | 992-1200px | Полный десктопный опыт |
| Большой десктоп | >1200px | Максимальная ширина контента, боковые панели |

### Гибкие макеты

Техники дизайна, адаптирующиеся к любому вьюпорту:

- Гибкие сетки с использованием процентов или единиц fr
- Плавная типографика с clamp() или единицами вьюпорта
- Адаптивные изображения с srcset и sizes
- Container queries для адаптивности на уровне компонентов

!!! example "Пример плавной типографики"
    ```css
    h1 {
      font-size: clamp(1.5rem, 4vw, 3rem);
    }
    ```
    Это плавно масштабирует размер заголовка между размерами вьюпорта.

## Мобильные вызовы

### Динамическая высота вьюпорта

Мобильные браузеры представляют уникальные вызовы вьюпорта:

- Показ/скрытие адресной панели изменяет высоту вьюпорта
- Виртуальная клавиатура уменьшает доступный вьюпорт
- Безопасные зоны на устройствах с вырезами/закруглёнными углами
- Изменения ориентации кардинально меняют вьюпорт

### Сенсорные взаимодействия

Соображения вьюпорта для сенсорных устройств:

- Минимальный размер цели касания: 44×44px (iOS) или 48×48px (Android)
- Зоны досягаемости большого пальца варьируются в зависимости от размера вьюпорта
- Жесты свайпа с края могут конфликтовать с краями вьюпорта
- Масштабирование щипком влияет на визуальный вьюпорт

!!! note "Соображение доступности"
    Пользователи могут масштабировать до 400% для доступности. Убедитесь, что ваш макет остаётся функциональным при различных масштабах вьюпорта.

## Влияние на производительность

### Загрузка ресурсов

Осведомлённость о вьюпорте оптимизирует доставку ресурсов:

- Ленивая загрузка изображений и видео под сгибом
- Приоритизация контента над сгибом в критическом CSS
- Откладывание невидимой функциональности JavaScript
- Реализация адаптивных изображений на основе вьюпорта

### Оптимизация рендеринга

Браузеры оптимизируют рендеринг на основе вьюпорта:

- Изначально отрисовывают только видимую область вьюпорта
- Виртуальная прокрутка для длинных списков
- Intersection Observer для действий, запускаемых вьюпортом
- CSS containment для элементов вне вьюпорта

## Стратегии оптимизации

### Приоритизация контента

Адаптируйте контент на основе ограничений вьюпорта:

- Показ/скрытие элементов на основе доступного пространства
- Переупорядочивание контента для мобильных вьюпортов
- Регулировка плотности информации
- Прогрессивное раскрытие для меньших вьюпортов

### Бюджеты производительности

Установите бюджеты производительности для конкретных вьюпортов:

| Тип вьюпорта | Целевое время загрузки | Максимальный вес страницы |
|--------------|------------------------|---------------------------|
| Мобильный (3G) | <3 секунд | <500KB |
| Мобильный (4G) | <2 секунд | <1MB |
| Десктоп (Broadband) | <1 секунда | <2MB |

### Рекомендации по тестированию

Комплексное тестирование вьюпорта включает:

- Тестирование на реальных устройствах разных размеров вьюпорта
- Эмуляция устройств в инструментах разработчика браузера
- Автоматизированное визуальное регрессионное тестирование
- Приоритетное тестирование вьюпорта на основе аналитики
- Тестирование масштабирования для доступности

!!! success "Лучшая практика"
    Тестируйте ваш сайт на этих критических ширинах вьюпорта: 320px, 375px, 768px, 1024px, 1366px и 1920px. Они покрывают большинство пользователей.

## Лучшие практики реализации

### Эффективное отслеживание вьюпорта

Эффективное отслеживание вьюпорта требует:

1. **Начальный захват вьюпорта** — запись размера вьюпорта при загрузке страницы
2. **Мониторинг событий изменения размера** — отслеживание изменений вьюпорта во время сессии
3. **Сегментация** — группировка вьюпортов в значимые категории
4. **Перекрёстный анализ** — корреляция вьюпорта с другими метриками
5. **Историческое отслеживание** — мониторинг трендов вьюпорта во времени

### Обработка особых случаев

**Складные устройства:**

- Множественные состояния вьюпорта
- Динамическое изменение соотношения сторон
- Адаптация интерфейса к режиму использования

**Ультраширокие мониторы:**

- Максимальная ширина контента
- Многоколоночные макеты
- Эффективное использование пространства

**Минимальные вьюпорты:**

- Умные часы и носимые устройства
- Упрощённые интерфейсы
- Приоритизация критической информации

## Будущие тенденции

### Развивающиеся тренды вьюпортов

Будьте готовы к эволюционирующему ландшафту вьюпортов:

- Складные устройства с множественными состояниями вьюпорта
- Ультраширокие мониторы, требующие особого внимания
- AR/VR вьюпорты с измерениями глубины
- Автомобильные дисплеи с уникальными ограничениями
- Носимые устройства с минимальными вьюпортами

### Новые CSS функции

Предстоящие CSS спецификации улучшают обработку вьюпорта:

- Container queries для адаптивности на основе компонентов
- Новые единицы вьюпорта (dvi, dvb для inline/block)
- Переменные окружения для настроек конкретного устройства
- Houdini API для пользовательских макетов с учётом вьюпорта

Вьюпорт остаётся критической концепцией в веб-разработке, непосредственно влияя на то, как пользователи воспринимают ваш контент. Наша аналитическая платформа предоставляет комплексные инструменты отслеживания и анализа вьюпорта, чтобы помочь вам оптимизировать для вашей реальной пользовательской базы, а не предположений.