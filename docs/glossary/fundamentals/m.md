# Отслеживание трафика субдоменов: почему это важно и как решать проблемы видимости

Субдомены — неотъемлемая часть современной веб-архитектуры. Компании используют их для разделения функциональных областей: `blog.example.com` для контента, `docs.example.com` для документации, `app.example.com` для основного приложения. При этом правильное отслеживание трафика между субдоменами становится критически важным для понимания поведения пользователей и оптимизации конверсий.

## Проблема невидимых субдоменов

Мы провели эксперимент с Plausible Analytics — популярным инструментом веб-аналитики, позиционирующим себя как простая и приватная альтернатива Google Analytics. После установки Plausible на домен с несколькими субдоменами и генерации тестового трафика мы обнаружили существенное ограничение.

При просмотре дашборда Plausible объединяет все уровни доменов без указания конкретного субдомена. Например, если пользователи посетили страницу `/index` как на основном домене, так и на субдомене, система показывает "2 хита на /index" без возможности определить, с какого именно субдомена пришёл трафик.

!!! warning "Ограничение Plausible"
    Plausible не отображает имена субдоменов в стандартных отчётах, что делает невозможным различение трафика между `www.example.com/page` и `blog.example.com/page` без дополнительной фильтрации.

## Почему разделение трафика субдоменов критично

### Разные аудитории и цели

Субдомены часто обслуживают различные сегменты аудитории с разными целями:

- `blog.example.com` — информационный контент для привлечения органического трафика
- `app.example.com` — функциональная часть для зарегистрированных пользователей
- `support.example.com` — поддержка клиентов
- `docs.example.com` — техническая документация для разработчиков

Без чёткого разделения трафика невозможно оценить эффективность каждого направления.

### Искажение метрик

Объединение данных субдоменов приводит к неточностям в ключевых метриках:

| Метрика | Проблема при объединении | Последствия |
|---------|-------------------------|------------|
| **Bounce Rate** | Смешивание показателей блога (высокий отказ нормален) с приложением (низкий отказ ожидаем) | Неверная оценка вовлечённости |
| **Time on Page** | Документация требует длительного чтения, лендинги — быстрых решений | Искажённое понимание качества контента |
| **Conversion Rate** | Конверсии на разных субдоменах имеют разную ценность | Невозможность оптимизации воронок |
| **Traffic Sources** | Источники трафика различаются для разных субдоменов | Неэффективное распределение маркетингового бюджета |

### Проблемы с атрибуцией конверсий

!!! info "Пример типичного пути пользователя"
    
    1. Пользователь находит статью на `blog.example.com` через поиск Google
    2. Читает несколько статей, изучая продукт
    3. Переходит на `www.example.com` для регистрации
    4. Использует `app.example.com` после регистрации
    5. Обращается к `docs.example.com` для настройки интеграций
    
    Без правильного отслеживания субдоменов этот путь выглядит как хаотичные переходы по одному домену.

## Текущие подходы к решению

### Plausible: частичные обходные пути

Plausible предлагает несколько вариантов работы с субдоменами:

**Вариант 1: Единый трекинг с фильтрацией**

Использование одного кода отслеживания на всех субдоменах с последующей фильтрацией по hostname. Этот подход сохраняет сессию пользователя при переходах между субдоменами, но требует ручной фильтрации для анализа.

**Вариант 2: Отдельные проекты**

Создание отдельного проекта в Plausible для каждого субдомена. Это даёт изолированную статистику, но теряется видимость кросс-доменных переходов.

**Вариант 3: Rollup Reporting (агрегированные отчёты)**

Платная функция, позволяющая объединять данные из нескольких проектов. Требует дополнительной настройки и увеличивает расходы.

!!! note "Особенности реализации в Plausible"
    Даже при использовании фильтрации по hostname, страницы с идентичными путями на разных субдоменах объединяются в отчёте "Top Pages". Для их разделения необходимо каждый раз применять фильтр, что усложняет рутинный анализ.

### Google Analytics 4: усложнённая настройка

GA4 требует дополнительной конфигурации для правильного отслеживания субдоменов:

- Настройка кросс-доменного трекинга
- Добавление субдоменов в список исключаемых источников
- Создание отдельных представлений или фильтров
- Настройка Enhanced Measurement для автоматического отслеживания

Эта сложность часто приводит к ошибкам конфигурации и потере данных.

### Matomo: гибкость с оговорками

Matomo предоставляет больше контроля над отслеживанием субдоменов, позволяя настраивать кастомные переменные и сегменты. Однако это требует технической экспертизы и времени на настройку.

## Наш подход к решению проблемы

Мы разрабатываем решение, которое автоматически распознаёт и правильно отображает трафик субдоменов без дополнительной настройки. Ключевые преимущества нашего подхода:

**Автоматическое разделение трафика**

Система автоматически определяет субдомен и сохраняет эту информацию для каждого события, позволяя анализировать данные как в совокупности, так и по отдельности.

**Сохранение контекста сессии**

При переходах между субдоменами сохраняется информация об источнике трафика и пути пользователя, обеспечивая правильную атрибуцию конверсий.

**Визуализация кросс-доменных путей**

Возможность построения полных путей пользователей через все субдомены с сохранением хронологии и контекста каждого перехода.

!!! tip "Практическое применение"
    
    - **Маркетологи** смогут точно определить, какие субдомены приносят конверсии
    - **Продуктовые менеджеры** увидят реальные пути пользователей между функциональными областями
    - **Разработчики** получат данные о производительности каждого субдомена отдельно
    - **SEO-специалисты** смогут оптимизировать каждый субдомен независимо

## Технические детали реализации

### Сбор данных

Наш JavaScript-код автоматически извлекает полный hostname из URL и передаёт его вместе с каждым событием. Это происходит прозрачно, без необходимости дополнительной конфигурации.

### Хранение и обработка

Данные о субдоменах сохраняются как отдельное измерение, позволяя:

- Фильтровать отчёты по конкретному субдомену
- Сравнивать метрики между субдоменами
- Строить агрегированные отчёты с разбивкой по субдоменам
- Отслеживать переходы между субдоменами как внутренний трафик

### Отчётность

В дашборде данные представлены на нескольких уровнях:

**Общий обзор**: совокупные метрики по всем субдоменам с индикацией активности каждого

**Детализация по субдоменам**: возможность углубиться в статистику конкретного субдомена

**Сравнительный анализ**: side-by-side сравнение метрик разных субдоменов

**Потоки пользователей**: визуализация переходов между субдоменами

## Влияние на ключевые метрики

Правильное отслеживание субдоменов существенно влияет на точность аналитики:

| Метрика | Без разделения | С разделением | Улучшение |
|---------|---------------|--------------|-----------|
| **Точность источников трафика** | 60-70% | 95-98% | +35% |
| **Правильная атрибуция конверсий** | 40-50% | 85-90% | +45% |
| **Понимание пути пользователя** | Фрагментарное | Полное | Качественное |
| **Время на принятие решений** | Часы анализа | Минуты | 10x быстрее |

!!! example "Кейс из практики"
    Интернет-магазин с блогом на субдомене после внедрения правильного отслеживания обнаружил, что 40% конверсий начинаются с чтения статей в блоге. Ранее эти конверсии приписывались прямому трафику. Это позволило перераспределить маркетинговый бюджет в пользу контент-маркетинга и увеличить ROI на 25%.

## Рекомендации по настройке субдоменов

### Архитектурные решения

При планировании структуры субдоменов учитывайте:

- **Функциональное разделение**: каждый субдомен должен иметь чёткую цель
- **SEO-влияние**: поисковики рассматривают субдомены как отдельные сайты
- **Техническая сложность**: больше субдоменов = сложнее инфраструктура
- **Аналитические возможности**: убедитесь, что ваш инструмент поддерживает нужный уровень детализации

### Выбор инструмента аналитики

При выборе системы аналитики для сайта с субдоменами оценивайте:

**Автоматическое отслеживание**: минимизация ручной настройки

**Гибкость фильтрации**: возможность быстро переключаться между представлениями

**Сохранение контекста**: правильная атрибуция при кросс-доменных переходах

**Экспорт данных**: возможность выгрузки данных с полной информацией о субдоменах

**Производительность**: скорость обработки запросов при большом количестве субдоменов

---

**🚀 Готовы получить полную картину трафика на ваших субдоменах?** Попробуйте наш инструмент аналитики бесплатно и увидьте реальные пути ваших пользователей через все субдомены. Никакой сложной настройки — просто установите один код на все субдомены и получите детальную аналитику с первого дня.